<div [formGroup]="form" class="form-group">
    <app-label labelBehavior [control]="control"></app-label>
    <div class="flex gap-2">
        @if (control.supported_countries) {
            <div class="sm:col-3 col-2 px-0 gap-1">
                <p-select [options]="supported_countries" optionLabel="name" [(ngModel)]="selectedCountry" [ngModelOptions]="{ standalone: true }" placeholder="Code" class="w-full md:w-56">
                    <ng-template #selectedItem let-selectedOption>
                        @if (selectedOption) {
                            <div class="flex items-center gap-2">
                                <img
                                    src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png"
                                    [class]="'flag flag-' + selectedOption.code.toLowerCase()"
                                    style="width: 23px"
                                />
                                <div>{{ selectedOption.name }}</div>
                            </div>
                        }
                    </ng-template>
                    <ng-template let-country #item>
                        <div class="flex items-center gap-2">
                            <img
                                src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png"
                                [class]="'flag flag-' + country.code.toLowerCase()"
                                style="width: 23px"
                            />
                            <div>{{ country.name }} - {{ country.complete_name }}</div>
                        </div>
                    </ng-template>
                    <ng-template #header>
                        <div class="font-medium px-3 pt-3 pb-0">Available Countries</div>
                    </ng-template>
                </p-select>
            </div>
        }
        <div class="px-0" [ngClass]="{'col': control.supported_countries, 'col-12': !control.supported_countries}">
            <p-inputmask [formControlName]="control.key!" [mask]="selectedCountry?.mask || defaultMask" [placeholder]="selectedCountry?.mask || defaultMask"  />
            <app-error-control [control]="control"></app-error-control>
            @if (control.help_text && (formContext.valid || !formContext.dirty)) {
                <small>{{ control.help_text }}</small>
            }
        </div>
    </div>
</div>